---
title: "Chapter 1"
author: "A.V. Zúñiga"
date: "12/21/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Task 5
```{r Task_5_setup, include=FALSE}
install.packages("smacof")
library(smacof)
load(paste0(base_url,"confusion.Rdata"))
```

# Introduction
In a study on Morse code signals Rothkopf (1957) asked 598 subjects to indicate for each pair of signals (acoustically presented after each other) whether the two signals were equal.
Note that each signal consists of a sequence of short beeps (0.05 sec) and long beeps (0.15sec) separated by a silence (0.05 sec).
The data set confusion.Rdata contains a 36 x 36 matrix of confusion rates for all pairs of signals included in the study. The signals in the subsequent rows of the confusing matrix are the letters of the alphabet A, B, C… in alphabetical order and the numbers 1,2,3,4,5,6,7,8,9,0.
The value in cell (i,j) of the matrix represents the percentage of subjects who indicated that signal i was equal to signal j, when signal j was presented after signal i.
 
We compute a symmetric matrix of similarities by taking the average of corresponding elements in the confusion matrix above and below the diagonal, next we convert the matrix of similarities into a matrix of dissimilarities, and finally we put all diagonal elements of the dissimilarity matrix equal to 0:

```{r Task_5_1, include=FALSE}
sim<-(confusion+t(confusion))/2 #similarity
dissim <- 100-sim #dissimilarity
for (i in 1:36){
  dissim[i,i]<-0   #diagonal 0
} 

str(sim) 
```


## Question 1 
1. Use smacofSym() to conduct MDS with 2 dimensions and assuming different
measurement levels (i.e., ratio, interval, mspline, ordinal) for the observed
dissimilarities.

1.1 ratio
```{r Task_5_11, include=FALSE}
m1 <- smacofSym(delta=confusion, ndim=2, type="ratio", init="torgerson")

```
1.2 interval 
```{r Task_5_12, include=FALSE}
m2 <- smacofSym(delta=confusion, ndim=2, type="interval", init="torgerson")
```

1.3 mspline
```{r Task_5_13, include=FALSE}
m3<-smacofSym(delta=confusion, ndim=2, type="mspline", spline.degree =4, spline.intKnots = 4, init="torgerson")
```

1.4 ordinal
```{r Task_5_14, include=FALSE}
m4 <- smacofSym(delta=confusion, ndim=2, type="ordinal", init="torgerson")

round(c(m1$stress,m2$stress,m3$stress,m4$stress),3)

par(mfrow=c(2,2))

plot(m3,plot.type="resplot",main="residual plot ordinal MDS")
plot(m3,plot.type="Shepard",main="Shepard diagram ordinal MDS")
plot(m4,plot.type="resplot",main="residual plot spline MDS")
plot(m4,plot.type="Shepard",main="Shepard diagram spline MDS")
#configuration ordinal MDS
plot(m3,plot.type="conf")

```

## Question 2
2. Evaluate the goodness of fit of solutions with different measurement levels using stress-1, and by computing stress norms with the functions randomstress() and permutation(). Discuss which solution you would select. Investigate the stability of the selected solution using the Jackknife.




## Question 3

3. Construct a data set of external variables that describe the signals (e.g. length of the signal, proportion of short beeps in the signal, etc.). Use an MDSbiplot to project the external variables in the configuration plot of the selected solution, and interpret the results of the analysis. 



